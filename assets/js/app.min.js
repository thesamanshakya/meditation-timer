var myTimer,customAudioFileName,bellSound,customSound,instructionSound,instructionType,displayArea=document.getElementById("timer"),btnAction=document.getElementById("btn-action"),wrapper=document.getElementById("wrapper"),bodyElem=document.getElementsByTagName("body")[0],menuOpener=document.getElementById("menu-opener"),navContainer=document.getElementById("nav-container"),isRunning=!1,intervalSwitch=document.getElementById("switch"),intervalLabel=document.getElementById("interval-label"),settingCog=document.getElementById("setting-cog"),instructionCheck=document.getElementById("instruction-check"),customAudioCheck=document.getElementById("instruction-custom"),instructionDropdown=document.getElementById("dropdown-instruction"),customAudioFile=document.getElementById("current-audio"),customPlayingElem=document.getElementById("c-playing"),customAudioTxt=document.getElementById("custom-audio-text"),myPresets={duration:10,extraTime:0,intervalBell:!1,instructionAudio:!1,instructionType:0,customAudio:!1,bell:0},totalTime=60*myPresets.duration,colorTheme=["purple","red","blue","pink","green"],n=0,bellSoundList=["gong-1","gong-2","gong-3","sn-goenka"],instructionsList=["anapan-goenka-1","anapan-goenka-2"];function setBellSound(e){bellSound=new Audio("media/bell/"+bellSoundList[e]+".mp3"),myPresets.bell=e}function setInstructionAudio(e){100==e?myPresets.customAudio=!0:instructionSound=new Audio("media/instructions/"+instructionsList[e]+".mp3"),myPresets.instructionType=e}setBellSound(n),colorTheme=colorTheme[Math.floor(Math.random()*colorTheme.length)],bodyElem.classList.add(colorTheme);var noSleep=new NoSleep,wakeLockEnabled=!1,intervalTxtArea=document.getElementById("int-bell"),quotesList=['"If you can breathe, you can meditate."<span>- Ajah Chah</span>','"Peace comes from within. Do not seek it without."<span> - The Buddha</span>','"Calmness of mind is one of the beautiful jewels of wisdom."<span> - James Allen</span>','"Whatever is fluid, soft, and yielding will overcome whatever is rigid and hard. What is soft is strong."<span> - Lao Tzu</span>','"When meditation is mastered, the mind is unwavering like the flame of a candle in a windless place."<span> - Bhagavad Gita</span>','"The best meditation is effortless. The best meditation is a gentle awareness."<span> - Maxime Lagacé</span>','"Inward calm cannot be maintained unless physical strength is constantly and intelligently replenished."<span> - The Buddha</span>','"Learn to be calm and you will always be happy."<span> - Paramahansa Yogananda</span>','"You will always be getting praise and blame, but do not let either affect the poise of the mind."<span> - The Buddha</span>','"Do not dwell in the past, do not dream of the future, concentrate the mind on the present moment."<span> -  The Buddha</span>','"Feelings come and go like clouds in a windy sky. Conscious breathing is my anchor."<span> - Thich Nhat Hahn</span>','"To understand the immeasurable, the mind must be extraordinarily quiet, still."<span> - Jiddu Krishnamurti</span>','"Meditation is like a gym in which you develop the powerful mental muscles of calm and insight."<span> - Ajahn Brahm</span>','"The act of meditation is being spacious."<span> - Sogyal Rinpoche</span>','"We must experience the Truth in a direct, practical and real way. This is only possible in the stillness and silence of the mind; and this is achieved by means of meditation."<span> - Samael Aun Weor</span>','"If the mind falls asleep, awaken it. Then if it starts wandering, make it quiet. If you reach the state where there is neither sleep nor movement of mind, stay still in that, the natural (real) state."<span> - Ramana Maharshi</span>','"The more regularly and the more deeply you meditate, the sooner you will find yourself acting always from a center of peace."<span> - J. Donald Walters</span>','"The trouble is, you think you have time."<span> - The Buddha</span>','"Believe nothing, no matter where you read it, or who said it, no matter if I have said it, unless it agrees with your own reason and your own common sense."<span> - The Buddha</span>','"No one saves us but ourselves. No one can and no one may. We ourselves must walk the path."<span> - The Buddha</span>','"The root of suffering is attachment."<span> - The Buddha</span>','"Your goal is not to battle with the mind, but to witness the mind."<span> - Swami Muktananda</span>','"To understand the immeasurable, the mind must be extraordinarily quiet, still. "<span> - Jiddu Krishnamurti</span>','"Learn this from water: loud splashes the brook but the oceans depth are calm."<span> - The Buddha</span>','"You only lose what you cling to."<span> - The Buddha</span>','"The past is already gone, the future is not yet here. There’s only one moment for you to live."<span> - The Buddha</span>','"Holding onto anger is like drinking poison and expecting the other person to die."<span> - The Buddha</span>','"What you think, you become. What you feel, you attract. What you imagine, you create."<span> - The Buddha</span>','"No one saves us but ourselves. No one can and no one may. We ourselves must walk the path."<span> - The Buddha</span>','"If you are quiet enough, you will hear the flow of the universe. You will feel its rhythm. Go with this flow. Happiness lies ahead. Meditation is key."<span> - The Buddha</span>','"To conquer oneself is a greater task than conquering others."<span> - The Buddha</span>','"Purity or impurity depends on oneself. No one can purify another."<span> - The Buddha</span>','"Work out your own salvation. Do not depend on others."<span> - The Buddha</span>','"Your worst enemy cannot harm you as much as your own unguarded thoughts."<span> - The Buddha</span>','"You will not be punished for your anger, you will be punished by your anger."<span> - The Buddha</span>','"Nothing is permanent."<span> - The Buddha</span>','"Thousands of candles can be lit from a single candle, and the life of the candle will not be shortened. Happiness never decreases by being shared."<span> - The Buddha</span>','"There is no path to happiness. Happiness is the path."<span> - The Buddha</span>','"Happiness does not depend on what you have or who you are. It solely relies on what you think."<span> - The Buddha</span>','"Happiness is not having a lot. Happiness is giving a lot."<span> - The Buddha</span>','"If you truly loved yourself, you could never hurt another."<span> - The Buddha</span>','"There is no path to happiness. Happiness is the path."<span> - The Buddha</span>'];function startTimer(e,t){var n,a,s,i=e;myTimer=setInterval(function(){n=parseInt(i/60/60),a=parseInt(i/60),s=parseInt(i%60),a=a>=60?parseInt(a%60):a,setDisplayArea(n=n<10?"0"+n:n,a=a<10?"0"+a:a,s=s<10?"0"+s:s),myPresets.intervalBell&&i==e/2&&(3==myPresets.bell?(setBellSound(0),playbellSound(),setBellSound(1)):playbellSound()),--i<0&&completedAction()},1e3)}function setDisplayArea(e,t,n){displayArea.innerText=e>0?e+":"+t+":"+n:t+":"+n}function completedAction(){instructionSound&&(instructionSound.pause(),instructionSound.currentTime=0),myPresets.customAudio&&stopCustomAudio(),wrapper.classList.remove("running"),bodyElem.classList.add(colorTheme),playbellSound(),clearInterval(myTimer),displayArea.innerText="Meditation completed!",displayArea.classList.add("animate__pulse"),displayArea.classList.add("complete"),btnAction.innerHTML="<i class='icon-play-button'></i>",btnAction.classList.add("animate__pulse"),isRunning=!1,noSleep.disable(),setTimeout(function(){timerParser(totalTime),displayArea.classList.remove("complete")},1e4)}function playbellSound(){bellSound.pause(),bellSound.currentTime=0,bellSound.play()}function startMeditationTimer(){wrapper.classList.add("running"),bodyElem.className="",myPresets.instructionAudio?(customPlayingElem.style.display="block",getInstructionType(),myPresets.customAudio?playCustomAudio():instructionSound.play(),100!==myPresets.instructionType?customAudioTxt.innerHTML=0==myPresets.instructionType?"Anapana Meditation ENGLISH - S.N Goenka":"Anapana Meditation HINDI - S.N Goenka":customAudioTxt.innerHTML=customAudioFileName):3==myPresets.bell?(setBellSound(0),playbellSound(),setBellSound(1)):playbellSound(),startTimer(totalTime,displayArea),btnAction.innerHTML="<i class='icon-stop-button'></i>",btnAction.classList.add("animate__pulse"),isRunning=!0,noSleep.enable(),setPreset()}function stopMeditationTimer(){wrapper.classList.remove("running"),customPlayingElem.style.display="none",bodyElem.classList.add(colorTheme),bellSound.pause(),bellSound.currentTime=0,instructionSound&&(instructionSound.pause(),instructionSound.currentTime=0),myPresets.customAudio&&stopCustomAudio(),timerParser(totalTime),clearInterval(myTimer),btnAction.innerHTML="<i class='icon-play-button'></i>",btnAction.classList.remove("animate__pulse"),isRunning=!1,noSleep.disable()}function getInstructionType(){document.querySelectorAll(".instruction-type").forEach(function(e){e.checked&&(100!==parseInt(e.value)&&(myPresets.customAudio=!1),myPresets.instructionType=parseInt(e.value),setInstructionAudio(parseInt(e.value)))})}btnAction.addEventListener("click",function(){if(instructionCheck.checked&&customAudioCheck.checked&&""==customAudioFile.innerText)return alert("Please select your audio file first."),void setTimeout(function(){settingCog.classList.add("active")},500);isRunning?stopMeditationTimer():startMeditationTimer()}),document.addEventListener("click",function(e){settingCog.contains(e.target)||settingCog.classList.remove("active")});let presetsArray=document.querySelectorAll(".presets a"),soundsArray=document.querySelectorAll(".bell-sound a"),extraTimeArray=document.querySelectorAll(".presets i");function timerParser(e){var t=new Date(1e3*e).toISOString();t=e/60<60?t.substr(14,5):t.substr(11,8),displayArea.innerText=t}presetsArray.forEach(function(e){e.addEventListener("click",function(){myPresets.extraTime=0,myPresets.duration=parseInt(this.getAttribute("data-time")),document.querySelectorAll(".presets li.active")[0].classList.remove("active"),this.parentNode.classList.add("active"),timerParser(totalTime=60*myPresets.duration),myPresets.intervalBell&&(intervalTxtArea.innerText="at "+Math.floor(totalTime/60/2)+" mins")})}),soundsArray.forEach(function(e,t){e.addEventListener("click",function(){bellSound.pause(),bellSound.currentTime=0,document.querySelectorAll(".bell-sound li.active")[0].classList.remove("active"),this.parentNode.classList.add("active"),setBellSound(t)})}),extraTimeArray.forEach(function(e){e.addEventListener("click",function(){var e=this.getAttribute("data-extra");myPresets.extraTime+=parseInt(e),timerParser(totalTime=60*(myPresets.extraTime+myPresets.duration)),myPresets.intervalBell&&(intervalTxtArea.innerText="at "+Math.floor(totalTime/60/2)+" mins")})});var quoteArea=document.getElementById("q-list");function getBatteryLevels(e){readBattery(e),setInterval(function(){readBattery(e)},12e4)}function readBattery(e){document.getElementById("batt").style.opacity="1",battery=e||battery;var t=parseFloat((100*battery.level).toFixed(2))+"%";document.getElementById("b-level").innerText=t,document.querySelector(".battery>span").style.width=t}quoteArea.innerHTML=quotesList[Math.floor(Math.random()*quotesList.length)],navigator.battery?getBatteryLevels(navigator.battery):navigator.getBattery&&navigator.getBattery().then(getBatteryLevels);var isMenuOpen=!1;function menuOpenClose(e){isMenuOpen?(navContainer.classList.remove("active"),isMenuOpen=!1):(navContainer.classList.add("active"),isMenuOpen=!0)}function setPreset(){"undefined"!=typeof Storage&&localStorage.setItem("mypreset",JSON.stringify(myPresets))}if(menuOpener.addEventListener("click",function(e){menuOpenClose(e)}),"undefined"!=typeof Storage){var localPresets=JSON.parse(localStorage.getItem("mypreset"));localPresets?setTimeout(function(){applyStoragePresets()},300):applyDefaultPresets()}else applyDefaultPresets();function applyDefaultPresets(){document.querySelectorAll(".bell-sound li")[0].classList.add("active"),document.querySelectorAll(".presets li")[0].classList.add("active"),timerParser(totalTime)}function applyStoragePresets(){myPresets=localPresets,setBellSound(localPresets.bell),document.querySelectorAll(".bell-sound li")[myPresets.bell].classList.add("active"),totalTime=60*(localPresets.duration+localPresets.extraTime);var e=30==localPresets.duration?1:60==localPresets.duration?2:0;document.querySelectorAll(".presets li")[e].classList.add("active"),timerParser(totalTime),intervalSwitch.checked=1==localPresets.intervalBell,setIntervalBellOnOff(intervalSwitch),instructionCheck.checked=1==localPresets.instructionAudio,setInstructionAudioOnOff(instructionCheck,localPresets.instructionType);let t=document.querySelectorAll(".instruction-type");localPresets.instructionAudio&&t.forEach(function(e,t){e.value==localPresets.instructionType&&(e.checked=!0)})}function setInstructionAudioOnOff(e,t=0){e.checked?(myPresets.instructionAudio=!0,instructionDropdown.classList.add("active"),setInstructionAudio(t)):(myPresets.instructionAudio=!1,instructionDropdown.classList.remove("active"))}function setIntervalBellOnOff(e){e.checked?(myPresets.intervalBell=!0,intervalTxtArea.innerText="at "+Math.floor(totalTime/60/2)+" mins"):(myPresets.intervalBell=!1,intervalTxtArea.innerText="is currently OFF")}if(intervalSwitch.addEventListener("change",function(e){setIntervalBellOnOff(this)}),settingCog.addEventListener("click",function(e){this.classList.toggle("active")}),instructionCheck.addEventListener("change",function(e){setInstructionAudioOnOff(this)}),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){let e;var installPrompt=document.querySelector(".install"),buttonInstall=document.getElementById("install-add");window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t,installPrompt.style.display="block"}),buttonInstall.addEventListener("click",t=>{installPrompt.remove(),e.prompt(),e.userChoice.then(e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt")})}),window.addEventListener("appinstalled",e=>{gtag("event","appInstall"),setTimeout(function(){alert("The Meditation Timer app has been installed successfully. Now you can access it via homescreen and also runs offline.")},7e3)})}var customPlayer=document.getElementById("custom-audio-elem"),customAudioNode=document.getElementById("custom-audio");function playCustomAudio(){customPlayer.src&&customPlayer.play()}function stopCustomAudio(){customPlayer.src&&(customPlayer.currentTime=0,customPlayer.pause())}function playSelectedFile(e){var t=this.files[0],n=t.type;customPlayer.canPlayType(n)?(customPlayer.src=URL.createObjectURL(t),customAudioFile.innerText=t.name,customAudioFileName=t.name):(stopCustomAudio(),alert("Sorry, this file cannot be played!"))}customAudioNode.addEventListener("change",playSelectedFile,!1);